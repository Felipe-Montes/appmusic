<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Playlists</title>
  <link rel="stylesheet" href="/css/app.css" />
</head>
<body>
<div class="app-shell">
  <header class="header">
    <div class="brand">
      <div class="logo" aria-hidden="true">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M9 19a4 4 0 1 1 0-8 4 4 0 0 1 0 8Zm8-9V4h-2v6.26A6 6 0 0 0 9 9v2a4 4 0 0 1 6 3.46V7h2Z" fill="white"/>
        </svg>
      </div>
      <div>AppMusic</div>
    </div>
    <nav class="nav">
      <a href="/ui">Inicio</a>
      <a href="/ui/artists">Artistas</a>
      <a href="/ui/albums">Álbumes</a>
      <a href="/ui/songs">Canciones</a>
      <a href="/ui/playlists">Playlists</a>
      <a href="/ui/users">Usuarios</a>
    </nav>
  </header>

  <main class="content">
    <div th:if="${param.error}" class="toast error">
      <div class="toast-body" th:text="${param.error[0]}">Ocurrió un error</div>
    </div>
    <h2 class="section-title">Playlists</h2>

    <div class="panel" style="margin-bottom: 16px;">
      <h3 style="margin-top:0">Listado</h3>
      <div class="table-wrap">
        <table>
          <thead>
          <tr>
            <th>ID</th>
            <th>Nombre</th>
            <th>Usuario</th>
            <th># Canciones</th>
            <th>Acciones</th>
          </tr>
          </thead>
          <tbody>
          <tr th:each="p : ${playlists}">
            <td th:text="${p.idPlaylist}">ID</td>
            <td th:text="${p.name}">Nombre</td>
            <td th:text="${p.user != null ? p.user.name : 'N/A'}">Usuario</td>
            <td th:text="${p.songs != null ? #lists.size(p.songs) : 0}">0</td>
            <td>
              <form th:action="@{/ui/playlists/delete}" method="post" style="display:inline">
                <input type="hidden" name="idPlaylist" th:value="${p.idPlaylist}" />
                <button class="button danger" type="submit">Eliminar</button>
              </form>
            </td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="panel" style="margin-bottom: 16px;">
      <h3 style="margin-top:0">Crear playlist</h3>
      <form class="form" action="/ui/playlists" method="post">
        <input class="input" name="idPlaylist" placeholder="ID" required />
        <input class="input" name="name" placeholder="Nombre" required />
        <select class="select" name="userId">
          <option value="">-- Usuario (opcional) --</option>
          <option th:each="u : ${users}" th:value="${u.idUser}" th:text="${u.name}"></option>
        </select>
        <select class="select" name="songIds" multiple size="5">
          <option th:each="s : ${songs}" th:value="${s.id}" th:text="${s.title}"></option>
        </select>
        <button class="button primary" type="submit">Guardar</button>
      </form>
      <p class="helper">Mantén presionada la tecla Ctrl (o Cmd en macOS) para seleccionar múltiples canciones.</p>
    </div>

    <div class="panel">
      <h3 style="margin-top:0">Actualizar playlist</h3>
      <form class="form" action="/ui/playlists/update" method="post">
        <input class="input" name="idPlaylist" placeholder="ID de playlist" required />
        <input class="input" name="name" placeholder="Nuevo nombre" required />
        <select class="select" name="userId">
          <option value="">-- Usuario (opcional) --</option>
          <option th:each="u : ${users}" th:value="${u.idUser}" th:text="${u.name}"></option>
        </select>
        <select class="select" name="songIds" multiple size="5">
          <option th:each="s : ${songs}" th:value="${s.id}" th:text="${s.title}"></option>
        </select>
        <button class="button primary" type="submit">Actualizar</button>
      </form>
    </div>
  </main>

  <footer class="footer">AppMusic • Demo UI</footer>
</div>
</body>
</html>
